# System utils

#include guard
[ ! -z "$system_defined" ] && [ -z "$FORCE_IMPORT_UTILITY" ] && return 0
export system_defined=1

importutility string

function system.findappbundleid() {
	osascript -e "id of app \"$1\""
	#echo 'id of app' "$1" 'is something'
	#echo "id of app $@"
}

function system.private.getcurrentdatehyphenated() {
  local curdate=$(date +'%Y-%m-%d-%T')
  curdate="${curdate//:/-}"
  echo $curdate
}

# Pass the character you want as the separator. If not given
# will use hyphen "-"
function system.getcurrentdate() {
	local separator=$1
	if string.isemptyorblank $separator
	then
		echo $(system.private.getcurrentdatehyphenated)
	else
		echo $(string.simplereplace $(system.private.getcurrentdatehyphenated) "-" "$separator")
	fi
}

function system.findfolder() {
	mdfind kind:folder "$1"
}

function system.whoisusingport8080() {
	lsof -i tcp:8080
	#netstat -an | grep 8080
}

function system.isprocessrunning() {
	if string.isemptyorblank $1
	then
		echo "Please enter the process name"
		return
	fi

	if [[ "$2" == "-partial" ]] || [[ "$2" == "--p" ]] || [[ "$2" == "--partial" ]] || [[ "$2" == "-p" ]] || [[ "$2" == "partial" ]]
	then
		# Allow partial match (don't use the -x)
		(pgrep -qi -- "$1")
	else
		(pgrep -xqi -- "$1")
	fi
}

# Call with command in paranthesis. For example: system.commandsucceeds $(open -a /Applications/Docker.app)
function system.commandsucceeds() {
    [ $? -eq 0 ]
}
